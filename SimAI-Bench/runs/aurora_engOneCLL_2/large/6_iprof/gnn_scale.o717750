
Due to MODULEPATH changes, the following have been reloaded:
  1) thapi/git.a63a1b8

The following have been reloaded with a version change:
  1) intel_compute_runtime/release/821.36 => intel_compute_runtime/release/803.29
  2) oneapi/eng-compiler/2024.04.15.002 => oneapi/release/2024.1
  3) ruby-babeltrace2/0.1.4-2pdqyna => ruby-babeltrace2/0.1.4-qgblvh6
  4) ruby-ffi/1.15.4-nsphezh => ruby-ffi/1.15.4-3s5qrmm
  5) ruby-narray-ffi/1.4.4-qp4dd6n => ruby-narray-ffi/1.4.4-a247i3f
  6) ruby-narray-old/0.6.1.2-myoz7p7 => ruby-narray-old/0.6.1.2-sp7oonz
  7) ruby-opencl/1.3.12-7kpspsc => ruby-opencl/1.3.12-ta3u46j
  8) ruby/3.1.0-pw6tzum => ruby/3.1.0-7boibpq

Loaded modules:

Currently Loaded Modules:
  1) mpich/icc-all-pmix-gpu/20231026       19) gdbm/1.23
  2) mpich-config/collective-tuning/1024   20) perl/5.38.0
  3) libfabric/1.15.2.0                    21) libmd/1.0.4-a3uixcr
  4) cray-pals/1.3.3                       22) libbsd/0.11.7-z5ynhgf
  5) cray-libpals/1.3.3                    23) expat/2.5.0-zbsye6z
  6) spack-pe-gcc/0.7.0-24.086.0           24) sqlite/3.43.2-agcdnqe
  7) gmp/6.2.1-pcxzkau                     25) python/3.10.11
  8) mpfr/4.2.0-w7v7yjv                    26) glib/2.78.0-545rz63
  9) mpc/1.3.1-dfagrna                     27) babeltrace2/2.0.6-ofgexfk
 10) gcc/12.2.0                            28) lttng-tools/2.12.11
 11) intel_compute_runtime/release/803.29  29) protobuf/3.21.12
 12) oneapi/release/2024.1                 30) ruby/3.1.0-7boibpq
 13) frameworks/2024.1                     31) ruby-ffi/1.15.4-3s5qrmm
 14) libiconv/1.17-ftdn3bs                 32) ruby-babeltrace2/0.1.4-qgblvh6
 15) gettext/0.22.3                        33) ruby-narray-old/0.6.1.2-sp7oonz
 16) elfutils/0.186-lyq5olj                34) ruby-narray-ffi/1.4.4-a247i3f
 17) pcre2/10.42-yay6thp                   35) ruby-opencl/1.3.12-ta3u46j
 18) berkeley-db/18.1.40-dby6xfz           36) thapi/git.a63a1b8

 


Torch version: 2.1.0.post0+cxx11.abi
IPEX version: 2.1.20+xpu
Torch Geometric version: 2.5.3

Number of nodes: 1
Number of ranks per node: 12
Number of total ranks: 12

Setting oneCCL bindings for 12 ranks per node

Running script /lus/flare/projects/Aurora_deployment/balin/Nek/GNN/GNN/SimAI-Bench/main.py
with arguments --device=xpu --iterations=10 --problem_size=large
Fri 02 Aug 2024 09:52:41 PM UTC
Hello from rank 1/12, local rank 1 on x4704c0s5b0n0
2024:08:02-21:52:56:(34757) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34757) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34757) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34757) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34757) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34757) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 10/12, local rank 10 on x4704c0s5b0n0
2024:08:02-21:52:56:(34761) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34761) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34761) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34761) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34761) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34761) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 2/12, local rank 2 on x4704c0s5b0n0
2024:08:02-21:52:56:(34774) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34774) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34774) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34774) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34774) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34774) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 7/12, local rank 7 on x4704c0s5b0n0
2024:08:02-21:52:56:(34768) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34768) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34768) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34768) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34768) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34768) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 8/12, local rank 8 on x4704c0s5b0n0
2024:08:02-21:52:56:(34770) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34770) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34770) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34770) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34770) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34770) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 11/12, local rank 11 on x4704c0s5b0n0
2024:08:02-21:52:56:(34767) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34767) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34767) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34767) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34767) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34767) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 4/12, local rank 4 on x4704c0s5b0n0
2024:08:02-21:52:56:(34752) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34752) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34752) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34752) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34752) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34752) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 5/12, local rank 5 on x4704c0s5b0n0
2024:08:02-21:52:56:(34750) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34750) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34750) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34750) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34750) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34750) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 3/12, local rank 3 on x4704c0s5b0n0
2024:08:02-21:52:56:(34746) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34746) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34746) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34746) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34746) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34746) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 6/12, local rank 6 on x4704c0s5b0n0
2024:08:02-21:52:56:(34771) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34771) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34771) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34771) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34771) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34771) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 9/12, local rank 9 on x4704c0s5b0n0
2024:08:02-21:52:56:(34769) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34769) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34769) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34769) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34769) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34769) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
[WARNING] yaksa: 2 leaked handle pool objects
Hello from rank 0/12, local rank 0 on x4704c0s5b0n0

Loaded data and model with 163491 parameters

Running on device: xpu 

2024:08:02-21:52:56:(34744) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:02-21:52:56:(34744) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:02-21:52:56:(34744) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34744) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:02-21:52:56:(34744) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:02-21:52:57:(34744) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0

Starting training loop ... 
[0]: avg_loss = 1.823401e-02
[1]: avg_loss = 1.689567e-02
[2]: avg_loss = 1.562115e-02
[3]: avg_loss = 1.458771e-02
[4]: avg_loss = 1.360435e-02
[5]: avg_loss = 1.272290e-02
[6]: avg_loss = 1.193064e-02
[7]: avg_loss = 1.127317e-02
[8]: avg_loss = 1.084258e-02
[9]: avg_loss = 1.062379e-02

Performance data averaged over 12 ranks and 8 iterations:
training_loop [s] : min = 1.040295e+01 , max = 1.040680e+01 , avg = 1.040401e+01 , std = 9.089709e-04 
train_tot [s] : min = 6.925647e+00 , max = 6.926464e+00 , avg = 6.926055e+00 , std = 2.786054e-04 
train_iter [s] : min = 8.636197e-01 , max = 8.682309e-01 , avg = 8.657569e-01 , std = 1.126395e-03 
throughput_iter [s] : min = 1.151767e+06 , max = 1.157917e+06 , avg = 1.155061e+06 , std = 1.502819e+03 
forward_pass [s] : min = 1.842038e-02 , max = 2.992250e-02 , avg = 1.988782e-02 , std = 2.899205e-03 
loss [s] : min = 2.193199e-04 , max = 3.292541e-04 , avg = 2.485047e-04 , std = 2.232855e-05 
backward_pass [s] : min = 6.709091e-02 , max = 8.004995e-02 , avg = 7.793984e-02 , std = 3.184004e-03 
optimizer_step [s] : min = 7.028634e-03 , max = 9.951053e-03 , avg = 7.554862e-03 , std = 7.076931e-04 
collectives [s] : min = 7.566945e-01 , max = 7.625931e-01 , avg = 7.598346e-01 , std = 1.247555e-03 
Average parallel training throughout [nodes/s] : 1.386073e+07
[WARNING] yaksa: 2 leaked handle pool objects
2024:08:02-21:53:19:(34744) |CCL_WARN| MPI_Finalize has been called before CCL finalization
THAPI: Trace location: /flare/Aurora_deployment/balin/Nek/GNN/GNN/SimAI-Bench/runs/aurora_engOneCLL_2/large/6_iprof/thapi-traces/02-08-2024_21-52-41
Fri 02 Aug 2024 09:53:25 PM UTC
