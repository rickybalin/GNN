
The following have been reloaded with a version change:
  1) intel_compute_runtime/release/821.36 => intel_compute_runtime/release/803.29
  2) oneapi/eng-compiler/2024.04.15.002 => oneapi/release/2024.1

Loaded modules:

Currently Loaded Modules:
  1) mpich/icc-all-pmix-gpu/20231026       6) spack-pe-gcc/0.7.0-24.086.0  11) intel_compute_runtime/release/803.29
  2) mpich-config/collective-tuning/1024   7) gmp/6.2.1-pcxzkau            12) oneapi/release/2024.1
  3) libfabric/1.15.2.0                    8) mpfr/4.2.0-w7v7yjv           13) frameworks/2024.1
  4) cray-pals/1.3.3                       9) mpc/1.3.1-dfagrna
  5) cray-libpals/1.3.3                   10) gcc/12.2.0

 


Torch version: 2.1.0.post0+cxx11.abi
IPEX version: 2.1.20+xpu
Torch Geometric version: 2.5.3

Number of nodes: 1
Number of ranks per node: 12
Number of total ranks: 12

Setting oneCCL bindings for 12 ranks per node

Running script /lus/flare/projects/Aurora_deployment/balin/Nek/GNN/GNN/SimAI-Bench/main.py
with arguments --device=xpu --iterations=100 --problem_size=large
Thu 01 Aug 2024 06:40:31 PM UTC
cpubind:list x4315c6s0b0n0 pid 190638 rank 0 0: mask 0x1c
cpubind:list x4315c6s0b0n0 pid 190639 rank 1 1: mask 0x1c00
cpubind:list x4315c6s0b0n0 pid 190640 rank 2 2: mask 0x1c0000
cpubind:list x4315c6s0b0n0 pid 190641 rank 3 3: mask 0x1c000000
cpubind:list x4315c6s0b0n0 pid 190642 rank 4 4: mask 0x1c00000000
cpubind:list x4315c6s0b0n0 pid 190643 rank 5 5: mask 0x1c0000000000
cpubind:list x4315c6s0b0n0 pid 190644 rank 6 6: mask 0x1c0000000000000
cpubind:list x4315c6s0b0n0 pid 190645 rank 7 7: mask 0x1c000000000000000
cpubind:list x4315c6s0b0n0 pid 190646 rank 8 8: mask 0x1c00000000000000000
cpubind:list x4315c6s0b0n0 pid 190647 rank 9 9: mask 0x1c0000000000000000000
cpubind:list x4315c6s0b0n0 pid 190648 rank 10 10: mask 0x1c000000000000000000000
cpubind:list x4315c6s0b0n0 pid 190649 rank 11 11: mask 0x1c00000000000000000000000
Hello from rank 0/12, local rank 0 on x4315c6s0b0n0
Hello from rank 1/12, local rank 1 on x4315c6s0b0n0
Hello from rank 2/12, local rank 2 on x4315c6s0b0n0
Hello from rank 3/12, local rank 3 on x4315c6s0b0n0
Hello from rank 4/12, local rank 4 on x4315c6s0b0n0
Hello from rank 5/12, local rank 5 on x4315c6s0b0n0
Hello from rank 6/12, local rank 6 on x4315c6s0b0n0
Hello from rank 7/12, local rank 7 on x4315c6s0b0n0
Hello from rank 8/12, local rank 8 on x4315c6s0b0n0
Hello from rank 9/12, local rank 9 on x4315c6s0b0n0
Hello from rank 10/12, local rank 10 on x4315c6s0b0n0
Hello from rank 11/12, local rank 11 on x4315c6s0b0n0

Loaded data and model with 163491 parameters

2024:08:01-18:40:41:(190649) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190649) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190649) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190649) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190649) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190644) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190644) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190644) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190644) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190644) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190648) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190648) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190648) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190648) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190648) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190641) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190641) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190641) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190641) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190641) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190642) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190642) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190642) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190642) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190642) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190640) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190640) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190640) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190640) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190640) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190639) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190639) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190639) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190639) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190639) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190646) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190646) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190646) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190646) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190645) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190645) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190645) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190645) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190646) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190645) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190643) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190643) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190643) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190643) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190647) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190647) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190647) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190647) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190643) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:41:(190647) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
Running on device: xpu 

2024:08:01-18:40:41:(190638) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:08:01-18:40:41:(190638) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:08:01-18:40:41:(190638) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190638) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:08:01-18:40:41:(190638) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:08:01-18:40:42:(190638) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190642) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190646) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190639) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190640) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190641) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190643) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190644) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190645) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190647) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190648) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0
2024:08:01-18:40:42:(190649) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0

Starting training loop ... 
[0]: avg_loss = 3.445741e-02
[1]: avg_loss = 3.103349e-02
[2]: avg_loss = 2.761118e-02
[3]: avg_loss = 2.418656e-02
[4]: avg_loss = 2.080591e-02
[5]: avg_loss = 1.739390e-02
[6]: avg_loss = 1.448144e-02
[7]: avg_loss = 1.245168e-02
[8]: avg_loss = 1.107931e-02
[9]: avg_loss = 1.059030e-02
[10]: avg_loss = 1.093059e-02
[11]: avg_loss = 1.165028e-02
[12]: avg_loss = 1.211832e-02
[13]: avg_loss = 1.206565e-02
[14]: avg_loss = 1.168794e-02
[15]: avg_loss = 1.120360e-02
[16]: avg_loss = 1.082674e-02
[17]: avg_loss = 1.063854e-02
[18]: avg_loss = 1.061171e-02
[19]: avg_loss = 1.065423e-02
[20]: avg_loss = 1.069821e-02
[21]: avg_loss = 1.071637e-02
[22]: avg_loss = 1.070491e-02
[23]: avg_loss = 1.065655e-02
[24]: avg_loss = 1.059175e-02
[25]: avg_loss = 1.053577e-02
[26]: avg_loss = 1.050197e-02
[27]: avg_loss = 1.049268e-02
[28]: avg_loss = 1.050868e-02
[29]: avg_loss = 1.052991e-02
[30]: avg_loss = 1.053467e-02
[31]: avg_loss = 1.051632e-02
[32]: avg_loss = 1.047953e-02
[33]: avg_loss = 1.043736e-02
[34]: avg_loss = 1.040546e-02
[35]: avg_loss = 1.039352e-02
[36]: avg_loss = 1.040165e-02
[37]: avg_loss = 1.042099e-02
[38]: avg_loss = 1.044024e-02
[39]: avg_loss = 1.045034e-02
[40]: avg_loss = 1.044802e-02
[41]: avg_loss = 1.043578e-02
[42]: avg_loss = 1.041857e-02
[43]: avg_loss = 1.040210e-02
[44]: avg_loss = 1.039097e-02
[45]: avg_loss = 1.038726e-02
[46]: avg_loss = 1.039024e-02
[47]: avg_loss = 1.039695e-02
[48]: avg_loss = 1.040359e-02
[49]: avg_loss = 1.040721e-02
[50]: avg_loss = 1.040664e-02
[51]: avg_loss = 1.040265e-02
[52]: avg_loss = 1.039720e-02
[53]: avg_loss = 1.039235e-02
[54]: avg_loss = 1.038941e-02
[55]: avg_loss = 1.038865e-02
[56]: avg_loss = 1.038943e-02
[57]: avg_loss = 1.039071e-02
[58]: avg_loss = 1.039160e-02
[59]: avg_loss = 1.039166e-02
[60]: avg_loss = 1.039092e-02
[61]: avg_loss = 1.038976e-02
[62]: avg_loss = 1.038863e-02
[63]: avg_loss = 1.038786e-02
[64]: avg_loss = 1.038748e-02
[65]: avg_loss = 1.038731e-02
[66]: avg_loss = 1.038709e-02
[67]: avg_loss = 1.038666e-02
[68]: avg_loss = 1.038601e-02
[69]: avg_loss = 1.038527e-02
[70]: avg_loss = 1.038465e-02
[71]: avg_loss = 1.038422e-02
[72]: avg_loss = 1.038396e-02
[73]: avg_loss = 1.038366e-02
[74]: avg_loss = 1.038310e-02
[75]: avg_loss = 1.038211e-02
[76]: avg_loss = 1.038071e-02
[77]: avg_loss = 1.037902e-02
[78]: avg_loss = 1.037744e-02
[79]: avg_loss = 1.037585e-02
[80]: avg_loss = 1.037420e-02
[81]: avg_loss = 1.037226e-02
[82]: avg_loss = 1.036965e-02
[83]: avg_loss = 1.036629e-02
[84]: avg_loss = 1.036221e-02
[85]: avg_loss = 1.035791e-02
[86]: avg_loss = 1.035270e-02
[87]: avg_loss = 1.034665e-02
[88]: avg_loss = 1.033976e-02
[89]: avg_loss = 1.033179e-02
[90]: avg_loss = 1.032242e-02
[91]: avg_loss = 1.031130e-02
[92]: avg_loss = 1.029816e-02
[93]: avg_loss = 1.028256e-02
[94]: avg_loss = 1.026419e-02
[95]: avg_loss = 1.024334e-02
[96]: avg_loss = 1.021957e-02
[97]: avg_loss = 1.019216e-02
[98]: avg_loss = 1.016090e-02
[99]: avg_loss = 1.012590e-02

Performance data averaged over 12 ranks and 98 iterations:
training_loop [s] : min = 8.808134e+01 , max = 8.808440e+01 , avg = 8.808266e+01 , std = 6.715760e-04 
train_tot [s] : min = 8.472487e+01 , max = 8.472549e+01 , avg = 8.472524e+01 , std = 1.923884e-04 
train_iter [s] : min = 8.598394e-01 , max = 8.684156e-01 , avg = 8.645433e-01 , std = 1.901516e-03 
throughput_iter [s] : min = 1.151522e+06 , max = 1.163008e+06 , avg = 1.156686e+06 , std = 2.544806e+03 
forward_pass [s] : min = 1.752573e-02 , max = 2.100676e-02 , avg = 1.931346e-02 , std = 5.843907e-04 
loss [s] : min = 1.999129e-04 , max = 3.655821e-04 , avg = 2.495187e-04 , std = 1.998603e-05 
backward_pass [s] : min = 4.756960e-02 , max = 5.341003e-02 , avg = 5.057913e-02 , std = 8.668846e-04 
optimizer_step [s] : min = 6.808098e-03 , max = 8.305877e-03 , avg = 7.385633e-03 , std = 2.327626e-04 
collectives [s] : min = 7.793120e-01 , max = 7.916596e-01 , avg = 7.867323e-01 , std = 2.240743e-03 
[WARNING] yaksa: 2 leaked handle pool objects
Average parallel training throughout [nodes/s] : 1.388023e+07
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
[WARNING] yaksa: 2 leaked handle pool objects
2024:08:01-18:42:22:(190638) |CCL_WARN| MPI_Finalize has been called before CCL finalization
Thu 01 Aug 2024 06:42:22 PM UTC
