
Due to MODULEPATH changes, the following have been reloaded:
  1) gcc/12.2.0             5) mpich-config/collective-tuning/1024
  2) gmp/6.2.1-pcxzkau      6) mpich/icc-all-pmix-gpu/20231026
  3) mpc/1.3.1-dfagrna      7) oneapi/eng-compiler/2024.04.15.002
  4) mpfr/4.2.0-w7v7yjv

The following have been reloaded with a version change:
  1) intel_compute_runtime/release/821.36 => intel_compute_runtime/release/775.20
  2) spack-pe-gcc/0.7.0-24.086.0 => spack-pe-gcc/0.6.1-23.275.2

     [1;96mUMD: agama-ci-devel-803.29 successfully loaded:[0m
     [1;96mUMD: graphics-compute-runtime/agama-ci-devel-803.29 [0m

The following have been reloaded with a version change:
  1) oneapi/eng-compiler/2024.04.15.002 => oneapi/release/2024.04.15.001

Loaded modules:

Currently Loaded Modules:
  1) libfabric/1.15.2.0
  2) cray-pals/1.3.3
  3) cray-libpals/1.3.3
  4) spack-pe-gcc/0.6.1-23.275.2
  5) gmp/6.2.1-pcxzkau
  6) mpfr/4.2.0-w7v7yjv
  7) mpc/1.3.1-dfagrna
  8) gcc/12.2.0
  9) mpich/icc-all-pmix-gpu/20231026
 10) mpich-config/collective-tuning/1024
 11) oneapi/release/2024.04.15.001
 12) graphics-compute-runtime/agama-ci-devel-803.29
 13) frameworks/2024.04.15.002

 


Torch versions

[notice] A new release of pip is available: 23.0.1 -> 24.0
[notice] To update, run: pip install --upgrade pip
intel-extension-for-pytorch        2.1.30+xpu
torch                              2.1.0.post2+cxx11.abi
torch-cluster                      1.6.1
torch_geometric                    2.5.3
torch-scatter                      2.1.1
torchvision                        0.16.0.post2+cxx11.abi

Number of nodes: 1
Number of ML ranks per node: 1
Number of ML total ranks: 1

Running script /gila/Aurora_deployment/balin/Nek/GNN/GNN/SimAI-Bench/main.py
with arguments --device=xpu --iterations=50 --problem_size=large
?RANK= 0 LOCAL_RANK= 0 gpu= 0.0?
Hello from rank 0/1, local rank 0 on x1921c1s2b0n0

Loaded data and model with 163491 parameters

Running on device: xpu 

2024:06:18-15:32:46:(69541) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:06:18-15:32:47:(69541) |CCL_WARN| MPI was initialized externaly but with unexpected thread level: required 3, provided 0

Starting training loop ... 
[0]: avg_loss = 1.588659e-02
[1]: avg_loss = 1.578310e-02
[2]: avg_loss = 1.568852e-02
[3]: avg_loss = 1.559393e-02
[4]: avg_loss = 1.549996e-02
[5]: avg_loss = 1.541144e-02
[6]: avg_loss = 1.532291e-02
[7]: avg_loss = 1.523403e-02
[8]: avg_loss = 1.514665e-02
[9]: avg_loss = 1.506099e-02
[10]: avg_loss = 1.497611e-02
[11]: avg_loss = 1.489122e-02
[12]: avg_loss = 1.480737e-02
[13]: avg_loss = 1.472421e-02
[14]: avg_loss = 1.464148e-02
[15]: avg_loss = 1.456009e-02
[16]: avg_loss = 1.447857e-02
[17]: avg_loss = 1.439741e-02
[18]: avg_loss = 1.431696e-02
[19]: avg_loss = 1.423743e-02
[20]: avg_loss = 1.415785e-02
[21]: avg_loss = 1.407823e-02
[22]: avg_loss = 1.399868e-02
[23]: avg_loss = 1.392061e-02
[24]: avg_loss = 1.384957e-02
[25]: avg_loss = 1.377903e-02
[26]: avg_loss = 1.370925e-02
[27]: avg_loss = 1.364005e-02
[28]: avg_loss = 1.357075e-02
[29]: avg_loss = 1.350221e-02
[30]: avg_loss = 1.343456e-02
[31]: avg_loss = 1.336731e-02
[32]: avg_loss = 1.330035e-02
[33]: avg_loss = 1.323414e-02
[34]: avg_loss = 1.316843e-02
[35]: avg_loss = 1.310299e-02
[36]: avg_loss = 1.303790e-02
[37]: avg_loss = 1.297288e-02
[38]: avg_loss = 1.290799e-02
[39]: avg_loss = 1.284332e-02
[40]: avg_loss = 1.277907e-02
[41]: avg_loss = 1.271519e-02
[42]: avg_loss = 1.265197e-02
[43]: avg_loss = 1.259043e-02
[44]: avg_loss = 1.252917e-02
[45]: avg_loss = 1.246782e-02
[46]: avg_loss = 1.240647e-02
[47]: avg_loss = 1.234534e-02
[48]: avg_loss = 1.228475e-02
[49]: avg_loss = 1.222541e-02

Summary of performance data:
training_loop [s] : min = 7.673859e+01 , max = 7.673859e+01 , avg = 7.673859e+01 , std = 0.000000e+00 
train_tot [s] : min = 3.470873e+00 , max = 3.470873e+00 , avg = 3.470873e+00 , std = 0.000000e+00 
train_iter [s] : min = 6.806976e-02 , max = 8.460280e-02 , avg = 7.083414e-02 , std = 2.368235e-03 
throughput_iter [s] : min = 1.181994e+07 , max = 1.469081e+07 , avg = 1.413164e+07 , std = 4.253081e+05 
[WARNING] yaksa: 2 leaked handle pool objects
Average parallel training throughout [nodes/s] : 1.413164e+07
2024:06:18-15:34:05:(69541) |CCL_WARN| MPI_Finalize has been called before CCL finalization
