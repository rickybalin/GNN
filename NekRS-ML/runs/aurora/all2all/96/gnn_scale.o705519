
The following have been reloaded with a version change:
  1) intel_compute_runtime/release/821.36 => intel_compute_runtime/release/803.29
  2) oneapi/eng-compiler/2024.04.15.002 => oneapi/release/2024.1

Loaded modules:

Currently Loaded Modules:
  1) mpich/icc-all-pmix-gpu/20231026
  2) mpich-config/collective-tuning/1024
  3) libfabric/1.15.2.0
  4) cray-pals/1.3.3
  5) cray-libpals/1.3.3
  6) spack-pe-gcc/0.7.0-24.086.0
  7) gmp/6.2.1-pcxzkau
  8) mpfr/4.2.0-w7v7yjv
  9) mpc/1.3.1-dfagrna
 10) gcc/12.2.0
 11) intel_compute_runtime/release/803.29
 12) oneapi/release/2024.1
 13) frameworks/2024.1

 


Torch version: 2.1.0.post0+cxx11.abi
IPEX version: 2.1.20+xpu
Torch Geometric version: 2.5.3

Number of nodes: 16
Number of ML ranks per node: 12
Number of ML total ranks: 192

Setting oneCCL bindings for 12 ranks per node

Running script /flare/Aurora_deployment/balin/Nek/GNN/GNN/NekRS-ML/main.py
with arguments backend=ccl halo_swap_mode=all_to_all gnn_outputs_path=/flare/Aurora_deployment/balin/Nek/GNN/weak_scale_data/500k_aurora/192/gnn_outputs_poly_5/

Thu 18 Jul 2024 07:03:54 PM UTC
[2024-07-18 19:04:46,647][__main__][INFO] - Hello from rank 0/192, local rank 0, on device xpu:0 out of 12.
[2024-07-18 19:04:46,647][__main__][INFO] - Hello from rank 6/192, local rank 6, on device xpu:6 out of 12.
[2024-07-18 19:04:46,647][__main__][INFO] - Hello from rank 1/192, local rank 1, on device xpu:1 out of 12.
[2024-07-18 19:04:46,648][__main__][INFO] - Hello from rank 2/192, local rank 2, on device xpu:2 out of 12.
[2024-07-18 19:04:46,647][__main__][INFO] - Hello from rank 3/192, local rank 3, on device xpu:3 out of 12.
[2024-07-18 19:04:46,647][__main__][INFO] - Hello from rank 4/192, local rank 4, on device xpu:4 out of 12.
[2024-07-18 19:04:46,647][__main__][INFO] - Hello from rank 5/192, local rank 5, on device xpu:5 out of 12.
[2024-07-18 19:04:46,648][__main__][INFO] - Hello from rank 7/192, local rank 7, on device xpu:7 out of 12.
[2024-07-18 19:04:46,648][__main__][INFO] - Hello from rank 8/192, local rank 8, on device xpu:8 out of 12.
[2024-07-18 19:04:46,648][__main__][INFO] - Hello from rank 11/192, local rank 11, on device xpu:11 out of 12.
[2024-07-18 19:04:46,648][__main__][INFO] - Hello from rank 10/192, local rank 10, on device xpu:10 out of 12.
[2024-07-18 19:04:46,652][__main__][INFO] - Hello from rank 9/192, local rank 9, on device xpu:9 out of 12.
[2024-07-18 19:04:47,451][__main__][INFO] - [RANK 6]: Loading positions and global node index
[2024-07-18 19:04:47,479][__main__][INFO] - [RANK 10]: Loading positions and global node index
[2024-07-18 19:04:47,511][__main__][INFO] - [RANK 5]: Loading positions and global node index
[2024-07-18 19:04:47,519][__main__][INFO] - [RANK 8]: Loading positions and global node index
[2024-07-18 19:04:47,527][__main__][INFO] - [RANK 1]: Loading positions and global node index
[2024-07-18 19:04:47,531][__main__][INFO] - [RANK 4]: Loading positions and global node index
[2024-07-18 19:04:47,538][__main__][INFO] - [RANK 7]: Loading positions and global node index
[2024-07-18 19:04:47,539][__main__][INFO] - [RANK 11]: Loading positions and global node index
[2024-07-18 19:04:47,540][__main__][INFO] - [RANK 2]: Loading positions and global node index
[2024-07-18 19:04:47,543][__main__][INFO] - [RANK 9]: Loading positions and global node index
[2024-07-18 19:04:47,543][__main__][INFO] - [RANK 3]: Loading positions and global node index
[2024-07-18 19:04:48,371][__main__][INFO] - [RANK 6]: Loading edge index
[2024-07-18 19:04:48,750][__main__][INFO] - [RANK 10]: Loading edge index
[2024-07-18 19:04:49,084][__main__][INFO] - [RANK 2]: Loading edge index
[2024-07-18 19:04:49,418][__main__][INFO] - [RANK 8]: Loading edge index
[2024-07-18 19:04:49,482][__main__][INFO] - [RANK 1]: Loading edge index
[2024-07-18 19:04:49,605][__main__][INFO] - [RANK 4]: Loading edge index
[2024-07-18 19:04:49,642][__main__][INFO] - [RANK 9]: Loading edge index
[2024-07-18 19:04:49,730][__main__][INFO] - [RANK 3]: Loading edge index
[2024-07-18 19:04:49,768][__main__][INFO] - [RANK 6]: Loading local unique mask
[2024-07-18 19:04:50,183][__main__][INFO] - [RANK 5]: Loading edge index
[2024-07-18 19:04:50,489][__main__][INFO] - [RANK 11]: Loading edge index
[2024-07-18 19:04:50,548][__main__][INFO] - [RANK 2]: Loading local unique mask
[2024-07-18 19:04:50,636][__main__][INFO] - [RANK 10]: Loading local unique mask
[2024-07-18 19:04:50,746][__main__][INFO] - [RANK 9]: Loading local unique mask
[2024-07-18 19:04:50,929][__main__][INFO] - [RANK 3]: Loading local unique mask
[2024-07-18 19:04:51,039][__main__][INFO] - [RANK 7]: Loading edge index
[2024-07-18 19:04:51,114][__main__][INFO] - [RANK 8]: Loading local unique mask
[2024-07-18 19:04:51,207][__main__][INFO] - [RANK 4]: Loading local unique mask
[2024-07-18 19:04:51,208][__main__][INFO] - [RANK 1]: Loading local unique mask
[2024-07-18 19:04:51,670][__main__][INFO] - [RANK 2]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:51,779][__main__][INFO] - [RANK 11]: Loading local unique mask
[2024-07-18 19:04:51,939][__main__][INFO] - [RANK 5]: Loading local unique mask
[2024-07-18 19:04:52,149][__main__][INFO] - [RANK 6]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:52,181][__main__][INFO] - [RANK 7]: Loading local unique mask
[2024-07-18 19:04:52,295][__main__][INFO] - [RANK 9]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:52,667][__main__][INFO] - [RANK 10]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:52,731][__main__][INFO] - [RANK 4]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:52,975][__main__][INFO] - [RANK 1]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:53,404][__main__][INFO] - [RANK 8]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:53,467][__main__][INFO] - [RANK 3]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:53,590][__main__][INFO] - [RANK 5]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:53,641][__main__][INFO] - [RANK 11]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:54,022][__main__][INFO] - [RANK 7]: Making the FULL GLL-based graph with overlapping nodes
[2024-07-18 19:04:55,983][__main__][INFO] - [RANK 6]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:56,054][__main__][INFO] - [RANK 9]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:56,242][__main__][INFO] - [RANK 10]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:56,329][__main__][INFO] - [RANK 4]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:56,895][__main__][INFO] - [RANK 2]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:57,161][__main__][INFO] - [RANK 8]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:57,372][__main__][INFO] - [RANK 6]: Getting idx_reduced2full
[2024-07-18 19:04:57,447][__main__][INFO] - [RANK 9]: Getting idx_reduced2full
[2024-07-18 19:04:57,609][__main__][INFO] - [RANK 10]: Getting idx_reduced2full
[2024-07-18 19:04:57,674][__main__][INFO] - [RANK 4]: Getting idx_reduced2full
[2024-07-18 19:04:58,298][__main__][INFO] - [RANK 1]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:58,498][__main__][INFO] - [RANK 8]: Getting idx_reduced2full
[2024-07-18 19:04:58,766][__main__][INFO] - [RANK 2]: Getting idx_reduced2full
[2024-07-18 19:04:58,876][__main__][INFO] - [RANK 5]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:58,895][__main__][INFO] - [RANK 3]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:58,959][__main__][INFO] - [RANK 11]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:04:58,996][__main__][INFO] - [RANK 7]: Making the REDUCED GLL-based graph with non-overlapping nodes
[2024-07-18 19:05:00,223][__main__][INFO] - [RANK 1]: Getting idx_reduced2full
[2024-07-18 19:05:00,311][__main__][INFO] - [RANK 7]: Getting idx_reduced2full
[2024-07-18 19:05:00,517][__main__][INFO] - [RANK 5]: Getting idx_reduced2full
[2024-07-18 19:05:00,787][__main__][INFO] - [RANK 3]: Getting idx_reduced2full
[2024-07-18 19:05:00,830][__main__][INFO] - [RANK 11]: Getting idx_reduced2full
[2024-07-18 19:05:02,070][__main__][INFO] - [RANK 9]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:02,086][__main__][INFO] - [RANK 6]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:02,277][__main__][INFO] - [RANK 10]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:02,394][__main__][INFO] - [RANK 4]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:02,781][__main__][INFO] - [RANK 10]: Found 8 neighboring processes: [ 2  3  6  7  8  9 11 12]
[2024-07-18 19:05:02,792][__main__][INFO] - [RANK 6]: Found 11 neighboring processes: [ 0  1  2  3  4  5  7  8  9 10 11]
[2024-07-18 19:05:03,266][__main__][INFO] - [RANK 9]: Found 8 neighboring processes: [ 2  3  6  7  8 10 11 12]
[2024-07-18 19:05:03,335][__main__][INFO] - [RANK 8]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:03,459][__main__][INFO] - [RANK 2]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:03,644][__main__][INFO] - [RANK 4]: Found 11 neighboring processes: [ 0  1  2  3  5  6  7 18 19 22 23]
[2024-07-18 19:05:04,561][__main__][INFO] - [RANK 2]: Found 11 neighboring processes: [ 0  1  3  4  5  6  7  8  9 10 11]
[2024-07-18 19:05:05,112][__main__][INFO] - [RANK 7]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:05,112][__main__][INFO] - [RANK 1]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:05,224][__main__][INFO] - [RANK 5]: Assembling halo_ids_list using reduced graph
2024:07:18-19:05:05:(142122) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:05:(142122) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:05:(142122) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:05:(142122) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:05:(142122) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
[2024-07-18 19:05:05,490][__main__][INFO] - [RANK 1]: Found 11 neighboring processes: [ 0  2  3  4  5  6  7 18 19 22 23]
[2024-07-18 19:05:05,529][__main__][INFO] - [RANK 11]: Assembling halo_ids_list using reduced graph
[2024-07-18 19:05:05,669][__main__][INFO] - [RANK 8]: Found 8 neighboring processes: [ 2  3  6  7  9 10 11 12]
[2024-07-18 19:05:05,679][__main__][INFO] - [RANK 3]: Assembling halo_ids_list using reduced graph
2024:07:18-19:05:05:(142126) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:05:(142126) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:05:(142126) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:05:(142126) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:05:(142126) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:07:18-19:05:06:(142125) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:06:(142125) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:06:(142125) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:06:(142125) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:06:(142125) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
[2024-07-18 19:05:06,653][__main__][INFO] - [RANK 5]: Found 11 neighboring processes: [ 0  1  2  3  4  6  7 18 19 22 23]
[2024-07-18 19:05:06,923][__main__][INFO] - [RANK 7]: Found 11 neighboring processes: [ 0  1  2  3  4  5  6  8  9 10 11]
2024:07:18-19:05:07:(142120) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:07:(142120) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:07:(142120) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:07:(142120) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:07:(142120) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
[2024-07-18 19:05:07,306][__main__][INFO] - [RANK 3]: Found 11 neighboring processes: [ 0  1  2  4  5  6  7  8  9 10 11]
2024:07:18-19:05:07:(142118) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:07:(142118) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:07:(142118) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:07:(142118) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:07:(142118) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
[2024-07-18 19:05:08,644][__main__][INFO] - [RANK 11]: Found 8 neighboring processes: [ 2  3  6  7  8  9 10 12]
2024:07:18-19:05:10:(142124) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:10:(142124) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:10:(142124) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:10:(142124) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:10:(142124) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:07:18-19:05:10:(142117) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:10:(142117) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:10:(142117) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:10:(142117) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:10:(142117) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:07:18-19:05:10:(142121) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:10:(142121) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:10:(142121) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:10:(142121) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:10:(142121) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:07:18-19:05:12:(142127) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:12:(142127) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:12:(142127) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:12:(142127) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:12:(142127) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:07:18-19:05:12:(142123) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:12:(142123) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:12:(142123) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:12:(142123) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:12:(142123) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
2024:07:18-19:05:12:(142119) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2024:07:18-19:05:12:(142119) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
2024:07:18-19:05:12:(142119) |CCL_WARN| CCL_CONFIGURATION_PATH= is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:12:(142119) |CCL_WARN| CCL_KVS_GET_TIMEOUT=600 is unknown to and unused by oneCCL code but is present in the environment, check if it is not mistyped.
2024:07:18-19:05:12:(142119) |CCL_WARN| MPI was initialized externally, CCL-MPI specific environment is ignored
